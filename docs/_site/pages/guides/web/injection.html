<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>0x01 - Injection Attacks - NSE Lab</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>0x01 - Injection Attacks | NSE Lab</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="0x01 - Injection Attacks" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation for the Division of Network and Systems Engineering’s Cyber Security Lab at KTH" /> <meta property="og:description" content="Documentation for the Division of Network and Systems Engineering’s Cyber Security Lab at KTH" /> <link rel="canonical" href="http://localhost:4000/pages/guides/web/injection.html" /> <meta property="og:url" content="http://localhost:4000/pages/guides/web/injection.html" /> <meta property="og:site_name" content="NSE Lab" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="0x01 - Injection Attacks" /> <script type="application/ld+json"> {"url":"http://localhost:4000/pages/guides/web/injection.html","@type":"WebPage","headline":"0x01 - Injection Attacks","description":"Documentation for the Division of Network and Systems Engineering’s Cyber Security Lab at KTH","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> NSE Lab </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/hacking_guides.html" class="nav-list-link">Hacking Guides</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pages/guides/pentest-process-planning.html" class="nav-list-link">Planning</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/guides/pentest-process-exploit.html" class="nav-list-link">Exploitation</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/guides/pentest-process-report.html" class="nav-list-link">Reporting</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/Wireless/wireless.html" class="nav-list-link">Wireless Hacking</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/wireshark.html" class="nav-list-link">Wireshark</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/wifi-mitm.html" class="nav-list-link">Wi-Fi MITM</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/bluetooth.html" class="nav-list-link">Bluetooth</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/lte-hacking.html" class="nav-list-link">Overview of LTE Hacking</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/soho-device_exploitation.html" class="nav-list-link">SOHO Device Exploitation</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/ubertooth.html" class="nav-list-link">Ubertooth One</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/arp-spoofing.html" class="nav-list-link">ARP Spoofing and MitM attacks</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/hardware/hardware.html" class="nav-list-link">Hardware Hacking</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/uart.html" class="nav-list-link">0x01 - Analyzing UART</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/i2c.html" class="nav-list-link">0x02 - Analyzing I2C</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/spi.html" class="nav-list-link">0x03 - Analyzing SPI</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/jtag.html" class="nav-list-link">0x04 - Analyzing JTAG</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/emmc.html" class="nav-list-link">0x05 - Analyzing eMMC</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/hardware_hacking.html" class="nav-list-link">0x06 - Useful links and tutorials</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/radio/radio.html" class="nav-list-link">Radio Hacking</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/radio/sdr.html" class="nav-list-link">0x01 - Analyzing SDR</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/radio/zigbee.html" class="nav-list-link">0x02 - Analyzing ZigBee</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/radio/ble.html" class="nav-list-link">0x03 - Analyzing BLE</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/radio/hackrf.html" class="nav-list-link">HackRF One</a> </li></ul></li><li class="nav-list-item "><a href="http://localhost:4000/pages/guides/firmware/firmware_hacking.html" class="nav-list-link">Firmware Hacking</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/fuzzing/fuzzing.html" class="nav-list-link">Fuzzing</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/fuzzing/introduction.html" class="nav-list-link">Introduction to Clusterfuzz</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/fuzzing/configuring-clusterfuzz.html" class="nav-list-link">Configuring the lab's Clusterfuzz service</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/fuzzing/start-stop.html" class="nav-list-link">Start/stop the Service</a> </li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/web/web.html" class="nav-list-link">Web Hacking</a><ul class="nav-list"><li class="nav-list-item active"> <a href="http://localhost:4000/pages/guides/web/injection.html" class="nav-list-link active">0x01 - Injection Attacks</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/authentication.html" class="nav-list-link">0x02 - Broken Authentication</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/sensitive-exposure.html" class="nav-list-link">0x03 - Sensitive Data Exposure</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/xxe.html" class="nav-list-link">0x04 - XML External Entities (XXE)</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/access-control.html" class="nav-list-link">0x05 - Broken Access Control</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/security-misconfiguration.html" class="nav-list-link">0x06 - Security Misconfiguration</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/xss.html" class="nav-list-link">0x07 - Cross Site Scripting (XSS)</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/insecure-deserialization.html" class="nav-list-link">0x08 - Insecure Deserialization</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/components.html" class="nav-list-link">0x09 - Using Components with Known Vulnerabilities</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/logging-and-monitoring.html" class="nav-list-link">0x10 - Insufficient Logging and Monitoring</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/http-request-smuggling.html" class="nav-list-link">0x11 - HTTP Request Smuggling</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/Creating%20threat%20models/Creating%20Threat%20Models.html" class="nav-list-link">Creating Threat Models</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/Prerequisites.html" class="nav-list-link">Prerequisites</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/MAL.html" class="nav-list-link">MAL</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/securiCAD.html" class="nav-list-link">securiCAD</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/DSL.html" class="nav-list-link">DSL</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/coreLang.html" class="nav-list-link">coreLang</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/thesis_guidelines/guidelines.html" class="nav-list-link">Thesis Guidelines</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/registration.html" class="nav-list-link">Registration</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/objective.html" class="nav-list-link">Objective</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/choice_of_system.html" class="nav-list-link">Choice of System to Explore</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/things_to_hack.html" class="nav-list-link">Things to hack</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/purchase_form.html" class="nav-list-link">Purchase Form</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/delimitations.html" class="nav-list-link">Delimitations</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/method.html" class="nav-list-link">Method</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/theory.html" class="nav-list-link">Theory</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/related_work.html" class="nav-list-link">Related work</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/thesis_report.html" class="nav-list-link">Thesis Report</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/threat_traceability_matrix.html" class="nav-list-link">Threat Traceability Matrix</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/grading_criteria.html" class="nav-list-link">Grading criteria</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/language.html" class="nav-list-link">Language</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/tutoring.html" class="nav-list-link">Tutoring</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/responsible_disclosure.html" class="nav-list-link">Responsible disclosure</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/the_law.html" class="nav-list-link">The Law</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/lab.html" class="nav-list-link">Cyber Security Lab</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/lab-equipment/lab-equipment.html" class="nav-list-link">Lab Equipment</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/iot-devices.html" class="nav-list-link">IoT Devices</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/hacking-tools.html" class="nav-list-link">Hacking Tools</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/computers.html" class="nav-list-link">Computers and hardware</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/books.html" class="nav-list-link">Books</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/lab-servers.html" class="nav-list-link">Lab Servers</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/vpn.html" class="nav-list-link">VPN</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/previous-work/previous-work.html" class="nav-list-link">Previous Work</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pages/previous-work/theses.html" class="nav-list-link">Published Theses</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/previous-work/media-coverage.html" class="nav-list-link">Media Coverage</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/previous-work/vulns.html" class="nav-list-link">Vulnerabilities Found</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/previous-work/social-media.html" class="nav-list-link">Social Media</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/pages/contribute.html" class="nav-list-link">Contribute</a></li><li class="nav-list-item"><a href="http://localhost:4000/pages/feedback.html" class="nav-list-link">Feedback</a></li><li class="nav-list-item"><a href="http://localhost:4000/pages/gallery.html" class="nav-list-link">Gallery</a></li><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search NSE Lab" aria-label="Search NSE Lab" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/pages/guides/hacking_guides.html">Hacking Guides</a></li> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/pages/guides/web/web.html">Web Hacking</a></li> <li class="breadcrumb-nav-list-item"><span>0x01 - Injection Attacks</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="injection-attacks"> <a href="#injection-attacks" class="anchor-heading" aria-labelledby="injection-attacks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Injection Attacks </h1> <p>When a system allows untrusted data to be entered into interpreters we say that the system is vulnerable to injection attacks. Examples include SQL, NoSQL, OS, and LDAP injection.[1]</p> <h2 id="sql-injection-sqli"> <a href="#sql-injection-sqli" class="anchor-heading" aria-labelledby="sql-injection-sqli"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SQL Injection (SQLi) </h2> <p>SQL stands for Structured Query Language, and is a language used for storing, manipulating, and retrieving data in relational databases.[2, 3] When a website doesn’t sanitize its incoming data, and that data is used to query a table in a database, a hacker could be able to access and manipulate data in that database using clever inputs. If the data is fetched through a login page, and the data within is storing users and their passwords, the consequences could be dire.</p> <h3 id="examples"> <a href="#examples" class="anchor-heading" aria-labelledby="examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples </h3> <h4 id="sql-injection-vulnerability-in-where-clause-allowing-retrieval-of-hidden-data"> <a href="#sql-injection-vulnerability-in-where-clause-allowing-retrieval-of-hidden-data" class="anchor-heading" aria-labelledby="sql-injection-vulnerability-in-where-clause-allowing-retrieval-of-hidden-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <b>SQL injection vulnerability in WHERE clause allowing retrieval of hidden data</b> </h4> <p>The following is a basic example from the <a href="https://portswigger.net/web-security">PortSwigger Web Security Academy</a>, specifically from the lab “SQL injection vulnerability in WHERE clause allowing retrieval of hidden data”.</p> <p>The lab is a website that looks like this: <img src="/pages/guides/images/we-like-to-shop-home.png" alt="The We Like to Shop homepage" /></p> <p>The shopping site displays 12 products and four categories that you can click on to filter through the displayed products. There is also a button to see all products. There are also some products that are hidden from the user, but still exist in the database. Those products are unreleased.</p> <p>In this lab, the goal is to find a way to exploit an SQLi vulnerability in the product category filter so that all products are listed, no matter their status as released or unreleased products.</p> <p>We are given the SQL query that is used in the backend:<br /> <code class="language-plaintext highlighter-rouge">SELECT * FROM products WHERE category = 'Gifts' AND released = 1</code></p> <p>The asterisk * is a wild card that means “all”. So, the query means that we want everything from the <code class="language-plaintext highlighter-rouge">products</code> table, where the category is ‘Gifts’ and the value of <code class="language-plaintext highlighter-rouge">released</code> is one.</p> <p>We can perform the SQL injection simply by editing the URL of the links to filter through the product categories. If you click on the link to see all products in the Gifts category for example, you get redirected to the following URL:<br /> <code class="language-plaintext highlighter-rouge">https://&lt;LAB_ID&gt;.web-security-academy.net/filter?category=Gifts</code></p> <p>Let’s say we didn’t know the website was vulnerable to SQL injections. How would we test that it was? Well, in SQL there are multiple syntactic features that we can use to check that. One of them is the single quote: ‘. Let’s try it out! We change our URL to the following instead:<br /> <code class="language-plaintext highlighter-rouge">https://&lt;LAB_ID&gt;.web-security-academy.net/filter?category='</code></p> <p>Something happens:<br /><br /> <img src="/pages/guides/images/we-like-to-shop-break.png" alt="Internal Server Error" /></p> <p>Why? Because the resulting query was this one:</p> <p><code class="language-plaintext highlighter-rouge">SELECT * FROM products WHERE category = ''' AND released = 1</code></p> <p>When SQL looks at this query, it thinks that it should grab all products where the category is ‘’ - that is, the empty string: nothing. Next, a new string starts with the last of the three single quotes, and presumably that string doesn’t end until the next single quote ‘ pops up in the backend code. The result is that SQL doesn’t know what to do with these weird patches of unintelligible statements, and thus, we get “Internal Server Error”.</p> <p>Great! Now we know that the site probably has an SQLi vulnerability. So how do we grab all those products then?</p> <p>Two useful SQL features that we are going to use to construct the SQLi query are OR statements and SQL comments. SQL comments are written like this: <code class="language-plaintext highlighter-rouge">--Example comment</code></p> <p>Just like with comments in other languages, SQL comments tell the computer that the text within it are not to be interpreted as code.</p> <p>We can use OR in combination with a boolean statement that is always true, such as 1=1, to reconstruct the WHERE part of the SELECT statement from before so that it’s always true.</p> <p>For example, consider the following SQL query:</p> <p><code class="language-plaintext highlighter-rouge">SELECT * FROM products WHERE category = 'Gifts' OR 1=1</code></p> <p>This means that SQL should get all products where the category is Gifts, OR where 1=1. Logically, that is true for all rows in the products table, since 1=1 is always true. So SQL gets all rows in the products table, and tada - we’re done!</p> <p>Before we celebrate however, we need to figure out how to actually make the backend SQL end up with a query such as that one. It doesn’t work to just type in “OR 1=1” in the end of your URL since that will result in a string, such as in the following query:</p> <p><code class="language-plaintext highlighter-rouge">SELECT * FROM products WHERE category = 'Gifts OR 1=1' AND released = 1</code></p> <p>We need to be a bit more clever with how we construct the query. First of all, we need to end the string before OR so that it’s interpreted as part of the query rather than just a string:</p> <p><code class="language-plaintext highlighter-rouge">https://&lt;LAB_ID&gt;.web-security-academy.net/filter?category=Gifts'OR 1=1</code></p> <p>Now we have the following query:</p> <p><code class="language-plaintext highlighter-rouge">SELECT * FROM products WHERE category = 'Gifts' OR 1=1' AND released = 1</code></p> <p>There is still a problem though:</p> <p><img src="/pages/guides/images/we-like-to-shop-break.png" alt="Internal Server Error" /></p> <p>Can you see why?</p> <p>We still have a lingering single quote after 1=1, which starts a new string that goes on all the way down until another single quote appears. We get the same issue as when we just entered the single quote when we checked if the site was vulnerable to SQL injections.</p> <p>How do we solve this? With SQL comments!</p> <p>If all the rest of the query is a comment, SQL will not interpret all that ugly broken code, and we’ll get rid of the “Internal Server Error”.</p> <p>Let’s enter the following into the URL:</p> <p><code class="language-plaintext highlighter-rouge">https://&lt;LAB_ID&gt;.web-security-academy.net/filter?category=Gifts'OR 1=1--</code></p> <p>This gives rise to this SQL query:</p> <p><code class="language-plaintext highlighter-rouge">SELECT * FROM products WHERE category = 'Gifts'OR 1=1--' AND released = 1</code></p> <p>The <code class="language-plaintext highlighter-rouge">AND released = 1</code> part now gets interpreted as a comment, and will not be included in the query. The result is that we tell SQL to select all from products where the category is Gifts, OR where 1=1 - i.e. all products, no matter the value of the <code class="language-plaintext highlighter-rouge">released</code> variable.</p> <p>Great! That concludes this first, very basic example of SQLi.</p> <p>There are more helpful examples at <a href="https://www.w3schools.com/sql/sql_injection.asp">W3Schools</a> and <a href="https://portswigger.net/web-security/">PortSwigger Web Security Academy</a>.</p> <h2 id="nosql-injection"> <a href="#nosql-injection" class="anchor-heading" aria-labelledby="nosql-injection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NoSQL Injection </h2> <p>NoSQL is a term that refers to all databases that (surprise) aren’t SQL databases.[4] Since SQL is for relational databases, another name for NoSQL databases is non-relational databases. Examples of NoSQL databases include MongoDB, Firebase, CouchDB and Redis.[4, 9] Even though SQL injection attacks don’t work on NoSQL databases, that doesn’t mean that NoSQL is invulnerable to injection attacks.</p> <p>You can read more at <a href="https://resources.infosecinstitute.com/topic/what-is-nosql-injection/">Infosec Institute</a>.</p> <h2 id="os-injection"> <a href="#os-injection" class="anchor-heading" aria-labelledby="os-injection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> OS Injection </h2> <p>OS Injection, also known as Command Injection or Shell Injection, is one of the more dangerous forms of injection attacks since a successful attack can compromise the entire application and its data.[6] If the attack is successful, a hacker is able to enter arbitrary shell commands. This often gives the same privileges to the hacker as the application has on its host infrastructure, and therefore not only can the app and its data be compromised, but other parts of the server hosting the app as well.</p> <p>You can read more at <a href="https://portswigger.net/web-security/os-command-injection">PortSwigger</a>, the creator of Burp Suite.</p> <h2 id="ldap-injection"> <a href="#ldap-injection" class="anchor-heading" aria-labelledby="ldap-injection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LDAP Injection </h2> <p>LDAP stands for Lightweight Directory Access Protocol, and is an application layer protocol used for accessing and maintaining distributed directory services over IP.[7]</p> <p>A directory service is a software application that allows many users to work with the same resource directories. LDAP uses the fact that directories can be seen as databases, where the information structure is a tree. One of the most common uses of LDAP is to search a directory tree for a specific resource, and it does this through special LDAP filters (defined in <a href="https://datatracker.ietf.org/doc/html/rfc4515">RFC 4515</a>). Through manipulating these filters and combining them with their own code injections, an attacker could be able to achieve their own objectives.[8]</p> <p>You can read a more thorough analysis of LDAP injection in <a href="https://www.researchgate.net/publication/224366575_LDAP_injection_techniques">LDAP injection techniques</a>.</p> <h2 id="references"> <a href="#references" class="anchor-heading" aria-labelledby="references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> References </h2> <p>[1] Top 10 Web Application Security Risks. <em>OWASP</em>. 2017. <a href="https://owasp.org/www-project-top-ten/">https://owasp.org/www-project-top-ten/</a>. (Fetched 2021-03-24)<br /> [2] SQL Tutorial. <em>W3Schools</em>. <a href="https://www.w3schools.com/sql/">https://www.w3schools.com/sql/</a>. (Fetched 2021-03-24)<br /> [3] SQL. <em>Wikipedia</em>. <a href="https://en.wikipedia.org/wiki/SQL">https://en.wikipedia.org/wiki/SQL</a>. (Fetched 2021-03-24)<br /> [4] NoSQL Database - What is NoSQL? <em>Microsoft Azure</em>. <a href="https://azure.microsoft.com/en-us/overview/nosql-database/">https://azure.microsoft.com/en-us/overview/nosql-database/</a>. (Fetched 2021-03-28)<br /> [5] NoSQL. <em>Wikipedia</em>. <a href="https://en.wikipedia.org/wiki/NoSQL">https://en.wikipedia.org/wiki/NoSQL</a>. (Fetched 2021-03-28)<br /> [6] OS command injection. <em>Portswigger</em>. <a href="https://portswigger.net/web-security/os-command-injection">https://portswigger.net/web-security/os-command-injection</a>. (Fetched 2021-03-28)<br /> [7] Lightweight Directory Access Protocol. <em>Wikipedia</em>. <a href="https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol">https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol</a>. (Fetched 2021-03-28)<br /> [8] J. M. Alonso, R. Bordon, M. Beltran and A. Guzman, “LDAP injection techniques,” 2008 11th IEEE Singapore International Conference on Communication Systems, Guangzhou, China, 2008, pp. 980-986, doi: 10.1109/ICCS.2008.4737330.<br /> [9] Cloud Firestore. <em>Google Firebase</em>. <a href="https://firebase.google.com/docs/firestore/">https://firebase.google.com/docs/firestore/</a>. (Fetched 2021-04-25)</p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Division of Network and Systems Engineering | KTH</p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>

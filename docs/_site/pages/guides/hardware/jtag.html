<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>0x04 - Analyzing JTAG - NSE Lab</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>0x04 - Analyzing JTAG | NSE Lab</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="0x04 - Analyzing JTAG" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation for the Division of Network and Systems Engineering’s Cyber Security Lab at KTH" /> <meta property="og:description" content="Documentation for the Division of Network and Systems Engineering’s Cyber Security Lab at KTH" /> <link rel="canonical" href="http://localhost:4000/pages/guides/hardware/jtag.html" /> <meta property="og:url" content="http://localhost:4000/pages/guides/hardware/jtag.html" /> <meta property="og:site_name" content="NSE Lab" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="0x04 - Analyzing JTAG" /> <script type="application/ld+json"> {"headline":"0x04 - Analyzing JTAG","description":"Documentation for the Division of Network and Systems Engineering’s Cyber Security Lab at KTH","@type":"WebPage","url":"http://localhost:4000/pages/guides/hardware/jtag.html","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> NSE Lab </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/thesis_guidelines/guidelines.html" class="nav-list-link">Thesis Guidelines</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/registration.html" class="nav-list-link">Registration</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/objective.html" class="nav-list-link">Objective</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/choice_of_system.html" class="nav-list-link">Choice of System to Explore</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/things_to_hack.html" class="nav-list-link">Things to hack</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/purchase_form.html" class="nav-list-link">Purchase Form</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/delimitations.html" class="nav-list-link">Delimitations</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/method.html" class="nav-list-link">Method</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/theory.html" class="nav-list-link">Theory</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/related_work.html" class="nav-list-link">Related work</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/thesis_report.html" class="nav-list-link">Thesis Report</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/threat_traceability_matrix.html" class="nav-list-link">Threat Traceability Matrix</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/grading_criteria.html" class="nav-list-link">Grading criteria</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/language.html" class="nav-list-link">Language</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/tutoring.html" class="nav-list-link">Tutoring</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/responsible_disclosure.html" class="nav-list-link">Responsible disclosure</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/the_law.html" class="nav-list-link">The Law</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/thesis_guidelines/lab.html" class="nav-list-link">Cyber Security Lab</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/hacking_guides.html" class="nav-list-link">Hacking Guides</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pages/guides/pentest-process-planning.html" class="nav-list-link">Planning</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/guides/pentest-process-exploit.html" class="nav-list-link">Exploitation</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/guides/pentest-process-report.html" class="nav-list-link">Reporting</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/Wireless/wireless.html" class="nav-list-link">Wireless Hacking</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/wireshark.html" class="nav-list-link">Wireshark</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/wifi-mitm.html" class="nav-list-link">Wi-Fi MITM</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/bluetooth.html" class="nav-list-link">Bluetooth</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/lte-hacking.html" class="nav-list-link">Overview of LTE Hacking</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/soho-device_exploitation.html" class="nav-list-link">SOHO Device Exploitation</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/ubertooth.html" class="nav-list-link">Ubertooth One</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Wireless/arp-spoofing.html" class="nav-list-link">ARP Spoofing and MitM attacks</a> </li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/hardware/hardware.html" class="nav-list-link">Hardware Hacking</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/uart.html" class="nav-list-link">0x01 - Analyzing UART</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/i2c.html" class="nav-list-link">0x02 - Analyzing I2C</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/spi.html" class="nav-list-link">0x03 - Analyzing SPI</a> </li><li class="nav-list-item active"> <a href="http://localhost:4000/pages/guides/hardware/jtag.html" class="nav-list-link active">0x04 - Analyzing JTAG</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/emmc.html" class="nav-list-link">0x05 - Analyzing eMMC</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/hardware/hardware_hacking.html" class="nav-list-link">0x06 - Useful links and tutorials</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/radio/radio.html" class="nav-list-link">Radio Hacking</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/radio/sdr.html" class="nav-list-link">0x01 - Analyzing SDR</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/radio/zigbee.html" class="nav-list-link">0x02 - Analyzing ZigBee</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/radio/ble.html" class="nav-list-link">0x03 - Analyzing BLE</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/radio/hackrf.html" class="nav-list-link">HackRF One</a> </li></ul></li><li class="nav-list-item "><a href="http://localhost:4000/pages/guides/firmware/firmware_hacking.html" class="nav-list-link">Firmware Hacking</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/fuzzing/fuzzing.html" class="nav-list-link">Fuzzing</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/fuzzing/introduction.html" class="nav-list-link">Introduction to Clusterfuzz</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/fuzzing/configuring-clusterfuzz.html" class="nav-list-link">Configuring the lab's Clusterfuzz service</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/fuzzing/start-stop.html" class="nav-list-link">Start/stop the Service</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/web/web.html" class="nav-list-link">Web Hacking</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/injection.html" class="nav-list-link">0x01 - Injection Attacks</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/authentication.html" class="nav-list-link">0x02 - Broken Authentication</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/sensitive-exposure.html" class="nav-list-link">0x03 - Sensitive Data Exposure</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/xxe.html" class="nav-list-link">0x04 - XML External Entities (XXE)</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/access-control.html" class="nav-list-link">0x05 - Broken Access Control</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/security-misconfiguration.html" class="nav-list-link">0x06 - Security Misconfiguration</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/xss.html" class="nav-list-link">0x07 - Cross Site Scripting (XSS)</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/insecure-deserialization.html" class="nav-list-link">0x08 - Insecure Deserialization</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/components.html" class="nav-list-link">0x09 - Using Components with Known Vulnerabilities</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/logging-and-monitoring.html" class="nav-list-link">0x10 - Insufficient Logging and Monitoring</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/web/http-request-smuggling.html" class="nav-list-link">0x11 - HTTP Request Smuggling</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/guides/Creating%20threat%20models/Creating%20Threat%20Models.html" class="nav-list-link">Creating Threat Models</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/Prerequisites.html" class="nav-list-link">Prerequisites</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/MAL.html" class="nav-list-link">MAL</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/securiCAD.html" class="nav-list-link">securiCAD</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/DSL.html" class="nav-list-link">DSL</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/pages/guides/Creating%20threat%20models/coreLang.html" class="nav-list-link">coreLang</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/lab-equipment/lab-equipment.html" class="nav-list-link">Lab Equipment</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/iot-devices.html" class="nav-list-link">IoT Devices</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/hacking-tools.html" class="nav-list-link">Hacking Tools</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/computers.html" class="nav-list-link">Computers and hardware</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/lab-equipment/books.html" class="nav-list-link">Books</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/pages/previous-work.html" class="nav-list-link">Previous Work</a></li><li class="nav-list-item"><a href="http://localhost:4000/pages/contribute.html" class="nav-list-link">Contribute</a></li><li class="nav-list-item"><a href="http://localhost:4000/pages/feedback.html" class="nav-list-link">Feedback</a></li><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search NSE Lab" aria-label="Search NSE Lab" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/pages/guides/hacking_guides.html">Hacking Guides</a></li> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/pages/guides/hardware/hardware.html">Hardware Hacking</a></li> <li class="breadcrumb-nav-list-item"><span>0x04 - Analyzing JTAG</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="analyzing-jtag"> <a href="#analyzing-jtag" class="anchor-heading" aria-labelledby="analyzing-jtag"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Analyzing JTAG </h1> <h2 id="1-jtag-internals"> <a href="#1-jtag-internals" class="anchor-heading" aria-labelledby="1-jtag-internals"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. JTAG Internals </h2> <ul> <li>JTAG is a hardware (debug) interface that communicates directly with the microcontroller <ul> <li>If the IoT device is not running a full-fledged OS or</li> <li>the hardware does not provide a serial interface,</li> <li>a lower-level debug approach, JTAG, is usually available</li> </ul> </li> <li>JTAG is a standard way of testing and debugging chips on the device <ul> <li>identifying manufacturing defects <ul> <li>identifying faulty components</li> <li>missing components in a PCB</li> <li>unconnected pins or incorrect placement of the device</li> </ul> </li> <li>device failure conditions</li> <li>accessing individual pin values on each chip</li> <li>overall system testing</li> <li>debugging the various chips (actually running binaries or firmware)</li> </ul> </li> <li>JTAG is not exactly a communication protocol</li> <li> <p>Access instructions are found on the chip or on the microcontroller specification</p> </li> <li>Operation mechanism <ul> <li>Testing technique is known as Boundary Scan <ul> <li>sends a data into one of the chips</li> <li>compares the output to the input</li> <li>verifies if it is OK</li> </ul> </li> <li>Boundary Scan cells embedded into the chips itself (near each pin)</li> <li>Boundary Scan description language file <ul> <li>defines the capabilities of any single device’s Boundary Scan logic</li> </ul> </li> <li>Boundary Scan instructions <ul> <li>BYPASS</li> <li>SAMPLE/PRELOAD</li> <li>EXTEST</li> </ul> </li> <li>TAP pins <ul> <li>TAP is a collective name given to the JTAG interfaces on a device</li> <li>Test Clock (TCK)</li> <li>Test Data In (TDI)</li> <li>Test Data Out (TDO)</li> <li>Test Mode Select (TMS)</li> <li>Test Reset (TRST, optional)</li> </ul> </li> <li>TAP controller machine <ul> <li>consists of TCK, TMS, TRST</li> <li>manages the overall exchange of data and instructions</li> </ul> </li> <li>I/O pins of the device <ul> <li>are connected serially that form a chain</li> <li>accessed by the Test Access Port (TAP) for testing</li> </ul> </li> <li>Testing (Boundary Scan) Process <ul> <li>TAP controller applies test data on the TDI pins</li> <li>BSR (Boundary Scan Register) monitors the input to the device</li> <li>Data is captured by the Boundary Scan cell</li> <li>Data then goes in the device through the TDI pins</li> <li>Data comes out of the device through the TDO pins</li> <li>Tester verifies the data on the output pin of the device</li> </ul> </li> </ul> </li> </ul> <h2 id="2-pentest-objectives"> <a href="#2-pentest-objectives" class="anchor-heading" aria-labelledby="2-pentest-objectives"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Pentest objectives </h2> <ul> <li>Bypass almost all software based security controls <ul> <li>set breakpoints</li> <li>inspect/modify registers/memory/stack</li> <li>change binary/firmware execution flow</li> <li>inject code into the process memory</li> <li>bypass login</li> </ul> </li> <li>Read from/write to flash chip <ul> <li>if PCB has JTAG access available and <ul> <li>contains an onboard flash chip, then the contents can be read/written via JTAG</li> </ul> </li> <li>dump firmware/bootloader</li> <li>write backdoored firmware</li> <li>flash modified firmware to device for bypassing restrictions</li> </ul> </li> <li>Debug interfaces sometimes deactivated intentionally for security purposes <ul> <li>either by software or hardware</li> </ul> </li> </ul> <h2 id="3-tools"> <a href="#3-tools" class="anchor-heading" aria-labelledby="3-tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Tools </h2> <ul> <li>JTAG pinout identifier <ul> <li>JTAGulator (or)</li> <li>JTAGEnum Arduino</li> </ul> </li> <li>Communication <ul> <li>minicom (or)</li> <li>screen (or)</li> <li>Attify Badge GUI</li> </ul> </li> <li>JTAG Converter/Adapter (any supported FTDI based hardware) <ul> <li>USB-TTL (or)</li> <li>BusPriate (or)</li> <li>Attify Badge (or)</li> <li>Segger J-Link</li> </ul> </li> <li>OpenOCD</li> <li>GDB-Multiarch</li> </ul> <h2 id="4-identify-jtag-pinouts"> <a href="#4-identify-jtag-pinouts" class="anchor-heading" aria-labelledby="4-identify-jtag-pinouts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Identify JTAG pinouts </h2> <ul> <li>Look JTAG pinouts up online to learn appearance <ul> <li>instead of pins or pads with holes, PCB usually have plain pads for JTAG</li> <li>therefore soldering experience is needed <ul> <li>to gain experience practice on Raspberry Pi or Intel Galileo</li> </ul> </li> </ul> </li> <li>Open the device</li> <li> <p>Identify the JTAG pads on the PCB</p> <div class="table-wrapper"><table> <tbody> <tr> <td>TCK</td> <td>Test Clock</td> </tr> <tr> <td>TDI</td> <td>Test Data In</td> </tr> <tr> <td>TDO</td> <td>Test Data Out</td> </tr> <tr> <td>TMS</td> <td>Test Mode Select</td> </tr> </tbody> </table></div> </li> <li>Method1: JTAGulator <ul> <li>open-source hardware</li> <li>has 24 I/O channels</li> <li>discovers JTAG and UART pinouts</li> <li> <p>screen or minicom is used for interaction</p> </li> <li>connect relevant pins on target device to the JTAGulator channels</li> <li> <p>connect GND to GND</p> </li> <li> <p>run a screen with the baudrate (need to identify before)</p> <p><code class="language-plaintext highlighter-rouge">screen /dev/ttyUSB0 115200</code></p> </li> <li>on the command line <ul> <li>enter V to set voltage (i.e 3.3)</li> <li>enter B to set number of channels for BYPASS scan instruction</li> </ul> </li> <li>JTAGulator identifies corresponding pinouts</li> </ul> </li> <li>Method2: Arduino flashed with JTAGEnum <ul> <li>much cheaper and slower</li> <li>discovers only JTAG pinouts</li> <li>Arduiono IDE <ul> <li>paste JTAGEnum application code</li> <li>select port and Arduino type from menu options</li> <li>upload</li> </ul> </li> <li>interact with Arduino via a serial connection <ul> <li>Serial Monitor of Arduino IDE or</li> <li>screen or</li> <li>minicom</li> </ul> </li> <li>on the command line <ul> <li>enter s to start scanning</li> </ul> </li> <li>JTAGEnum identifies corresponding pinouts</li> </ul> </li> </ul> <h2 id="5-connecting-jtag"> <a href="#5-connecting-jtag" class="anchor-heading" aria-labelledby="5-connecting-jtag"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5. Connecting JTAG </h2> <ul> <li>OpenOCD <ul> <li>open-source software</li> <li>to perform On Chip Debugging via JTAG</li> <li>interacts with a hardware debugger’s JTAG port <ul> <li>debug chips</li> <li>set breakpoints</li> <li>program and interact flash chips</li> <li>dump firmware and sensitive data</li> </ul> </li> </ul> </li> <li> <p>Adapter (Attify Badge) pin layout</p> <div class="table-wrapper"><table> <tbody> <tr> <td>D0</td> <td>TCK Test Clock</td> </tr> <tr> <td>D1</td> <td>TDI Test Data In</td> </tr> <tr> <td>D2</td> <td>TDO Test Data Out</td> </tr> <tr> <td>D3</td> <td>TMS Test Mode Select</td> </tr> </tbody> </table></div> </li> <li> <p>Connect the JTAG pins to the adapter (Attify Badge)</p> <div class="table-wrapper"><table> <thead> <tr> <th>JTAG</th> <th>Adapter</th> </tr> </thead> <tbody> <tr> <td>CLK</td> <td>TCK (D0)</td> </tr> <tr> <td>TDI</td> <td>TDI (D1)</td> </tr> <tr> <td>TDO</td> <td>TDO (D2)</td> </tr> <tr> <td>TMS</td> <td>TMS (D3)</td> </tr> </tbody> </table></div> <ul> <li>NOTE: The pins functioning as CLK, TDI, TDO, and TMS differs <ul> <li>based on the processor or controller of the target device.</li> <li>Need to review datasheet</li> </ul> </li> <li>find the OpenOCD configuration file for the adapter (Attify Badge JTAG) <ul> <li>badge.cfg is available</li> </ul> </li> <li>find the configuration file for the device <ul> <li> <p>check if the target device’s TAP controller is supported by OpenOCD</p> <p><code class="language-plaintext highlighter-rouge">ls openocs/tcl/&lt;target&gt;</code></p> </li> <li> <p>if it does not exists, manually create one for it</p> </li> </ul> </li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openocd –c "telnet_port 2121" –f badge.cfg –f target.cfg
  
telnet localhost 2121
reset init
flash banks
halt
</code></pre></div> </div> </li> </ul> <h2 id="6-read-data"> <a href="#6-read-data" class="anchor-heading" aria-labelledby="6-read-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 6. Read data </h2> <ul> <li>Read data over JTAG</li> <li> <p>Method 1</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>flash banks
dump_image firmware.bin 0x08000000 0x00010000
flash banks
</code></pre></div> </div> </li> <li> <p>Method 2</p> <p><code class="language-plaintext highlighter-rouge">mwd 0x00 0x20</code></p> </li> </ul> <h2 id="7-write-data-to-target"> <a href="#7-write-data-to-target" class="anchor-heading" aria-labelledby="7-write-data-to-target"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 7. Write data to target </h2> <ul> <li> <p>Write data over JTAG</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>flash banks
flash write_image erase firmware.bin 0x08000000
flash banks
</code></pre></div> </div> </li> </ul> <h2 id="8-debugging-with-gdb"> <a href="#8-debugging-with-gdb" class="anchor-heading" aria-labelledby="8-debugging-with-gdb"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8. Debugging with GDB </h2> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gdb-multiarch program.bin
  set architecture arm
  target remote localhost:3333
</code></pre></div></div> <ul> <li>hbreak &lt; function-name &gt;</li> <li>continue standard binary reversing</li> </ul> <h2 id="references"> <a href="#references" class="anchor-heading" aria-labelledby="references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> References </h2> <ul> <li><a href="https://blog.senr.io/blog/jtag-explained">JTAG Explained</a></li> </ul> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Division of Network and Systems Engineering | KTH</p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
